.data
DAT_140058cc0 qword 00405060700010203h
pad1 qword 00C0D0E0F08090A0Bh
DAT_140059da0 qword 00706050403020100h
pad2 qword 00F0E0D0C0B0A0908h
DAT_140059ea0 qword 071374491428A2F98h
pad3 qword 0E9B5DBA5B5C0FBCFh
DAT_140059e50 qword 059F111F13956C25Bh
pad4 qword 0AB1C5ED5923F82A4h
DAT_140059e00 qword 012835B01D807AA98h
pad5 qword 0550C7DC3243185BEh
DAT_140059e70 qword 080DEB1FE72BE5D74h
pad6 qword 0C19BF1749BDC06A7h
DAT_140059dd0 qword 0EFBE4786E49B69C1h
pad7 qword 0240CA1CC0FC19DC6h
DAT_140059e20 qword 04A7484AA2DE92C6Fh
pad8 qword 076F988DA5CB0A9DCh
DAT_140059e60 qword 0A831C66D983E5152h
pad9 qword 0BF597FC7B00327C8h
DAT_140059dc0 qword 0D5A79147C6E00BF3h
pad10 qword 01429296706CA6351h
DAT_140059df0 qword 02E1B213827B70A85h
pad11 qword 053380D134D2C6DFCh
DAT_140059e40 qword 0766A0ABB650A7354h
pad12 qword 092722C8581C2C92Eh
DAT_140059e90 qword 0A81A664BA2BFE8A1h
pad13 qword 0C76C51A3C24B8B70h
DAT_140059db0 qword 0D6990624D192E819h
pad14 qword 0106AA070F40E3585h
DAT_140059de0 qword 01E376C0819A4C116h
pad15 qword 034B0BCB52748774Ch
DAT_140059e10 qword 04ED8AA4A391C0CB3h
pad16 qword 0682E6FF35B9CCA4Fh
DAT_140059e30 qword 078A5636F748F82EEh
pad17 qword 08CC7020884C87814h
DAT_140059e80 qword 0A4506CEB90BEFFFAh
pad18 qword 0C67178F2BEF9A3F7h

.code
EncryptKey proc
	SUB       RSP, 0a8h

	MOVAPS    xmmword ptr [RSP + 050h], XMM10
	
	MOVAPS    xmmword ptr [RSP + 040h], XMM11
	
	MOVAPS    xmmword ptr [RSP + 030h], XMM12
	
	MOVDQU    XMM0, xmmword ptr [RCX]
	
	MOVDQU    XMM1, xmmword ptr [RCX + 010h]
	
	CMP       R9D, 1h
	
	JNZ       LAB_1400251a3

	MOVDQA    XMM12, xmmword ptr [DAT_140058cc0]
	
	JMP       LAB_1400251ac
LAB_1400251a3:
	MOVDQA    XMM12, xmmword ptr [DAT_140059da0]     
LAB_1400251ac:
	PSHUFD    XMM0, XMM0, 0b1h
	
	PSHUFD    XMM11, XMM1, 01bh
	
	MOVDQA    XMM10, XMM0
	
	PALIGNR   XMM10, XMM11, 08h

	PBLENDW   XMM11, XMM0, 0f0h

	CMP       R8, 040h

	JC        LAB_140025555
LAB_1400251d4:
	MOVAPS    xmmword ptr [RSP + 090h],XMM6
	
	ADD       RDX, 020h
	
	MOVAPS    xmmword ptr [RSP + 080h],XMM7
	
	MOVAPS    xmmword ptr [RSP + 070h],XMM8
	
	MOVAPS    xmmword ptr [RSP + 060h],XMM9
	
	MOVAPS    xmmword ptr [RSP + 020h],XMM13
	
	MOVDQA    XMM13, xmmword ptr [DAT_140059ea0]
	
	MOVAPS    xmmword ptr [RSP + 010h],XMM14
	
	MOVDQA    XMM14, xmmword ptr [DAT_140059e50]
	
	MOVAPS    xmmword ptr [RSP],XMM15
	
	MOVDQA    XMM15, xmmword ptr [DAT_140059e00]
	
	SHR       R8, 06h
	
	NOP       dword ptr [RAX]
	
	NOP       dword ptr [RAX + RAX*01h]
LAB_140025230:
	MOVDQU    XMM1,xmmword ptr [RDX + -020h]
	
	MOVDQU    XMM2,xmmword ptr [RDX + -010h]
	
	MOVDQU    XMM3,xmmword ptr [RDX]
	
	MOVDQU    XMM4,xmmword ptr [RDX + 010h]
	
	PSHUFB    XMM2,XMM12
	
	MOVDQA    XMM9,XMM10
	
	MOVDQA    XMM0,XMM13
	
	PSHUFB    XMM3,XMM12
	
	PSHUFB    XMM4,XMM12
	
	PSHUFB    XMM1,XMM12
	
	MOVDQA    XMM5,XMM4
	
	MOVDQA    XMM8,XMM11
	
	PADDD     XMM0,XMM1
	
	PALIGNR   XMM5,XMM3,04h
	
	SHA256RNDS2   XMM8,XMM10,XMM0
	
	PSHUFD    XMM0,XMM0,0eh
	
	SHA256RNDS2   XMM10,XMM8,XMM0
	
	SHA256MSG1   XMM1,XMM2
	
	PADDD     XMM5,XMM1
	
	MOVDQA    XMM0,XMM14
	
	PADDD     XMM0,XMM2
	
	SHA256RNDS2   XMM8,XMM10,XMM0
	
	PSHUFD    XMM0,XMM0,0eh
	
	SHA256RNDS2   XMM10,XMM8,XMM0
	
	SHA256MSG1   XMM2,XMM3
	
	SHA256MSG2   XMM5,XMM4
	
	MOVDQA    XMM6,XMM5
	
	MOVDQA    XMM0,XMM15
	
	PADDD     XMM0,XMM3
	
	PALIGNR   XMM6,XMM4,04h
	
	SHA256RNDS2   XMM8,XMM10,XMM0
	
	PSHUFD    XMM0,XMM0,0eh
	
	PADDD     XMM6,XMM2
	
	SHA256RNDS2   XMM10,XMM8,XMM0
	
	MOVDQA    XMM0,xmmword ptr [DAT_140059e70]
	
	PADDD     XMM0,XMM4
	
	SHA256RNDS2   XMM8,XMM10,XMM0
	
	PSHUFD    XMM0,XMM0,0eh
	
	SHA256RNDS2   XMM10,XMM8,XMM0
	
	MOVDQA    XMM0,xmmword ptr [DAT_140059dd0]
	
	PADDD     XMM0,XMM5
	
	SHA256RNDS2   XMM8,XMM10,XMM0
	
	PSHUFD    XMM0,XMM0,0eh
	
	SHA256RNDS2   XMM10,XMM8,XMM0
	
	MOVDQA    XMM0,xmmword ptr [DAT_140059e20]
	
	SHA256MSG2   XMM6,XMM5
	
	PADDD     XMM0,XMM6
	
	MOVDQA    XMM2,XMM6
	
	SHA256RNDS2   XMM8,XMM10,XMM0
	
	PSHUFD    XMM0,XMM0,0eh
	
	SHA256RNDS2   XMM10,XMM8,XMM0
	
	MOVDQA    XMM0,xmmword ptr [DAT_140059e60]
	
	
	SHA256MSG1   XMM3,XMM4
	
	PALIGNR   XMM2,XMM5,04h
	
	PADDD     XMM2,XMM3
	
	SHA256MSG2   XMM2,XMM6
	
	PADDD     XMM0,XMM2
	
	MOVDQA    XMM3,XMM2
	
	SHA256RNDS2   XMM8,XMM10,XMM0
	
	PSHUFD    XMM0,XMM0,0eh
	
	SHA256RNDS2   XMM10,XMM8,XMM0
	
	MOVDQA    XMM0,xmmword ptr [DAT_140059dc0]
	
	PALIGNR   XMM3,XMM6,04h
	
	SHA256MSG1   XMM4,XMM5
	
	SHA256MSG1   XMM5,XMM6
	
	PADDD     XMM3,XMM4
	
	SHA256MSG2   XMM3,XMM2
	
	PADDD     XMM0,XMM3
	
	MOVDQA    XMM7,XMM3
	
	SHA256RNDS2   XMM8,XMM10,XMM0
	
	PALIGNR   XMM7,XMM2,04h
	
	PSHUFD    XMM0,XMM0,0eh
	
	PADDD     XMM7,XMM5
	
	SHA256RNDS2   XMM10,XMM8,XMM0
	
	MOVDQA    XMM0,xmmword ptr [DAT_140059df0]
	
	SHA256MSG2   XMM7,XMM3
	
	PADDD     XMM0,XMM7
	
	MOVDQA    XMM1,XMM7
	
	SHA256MSG1   XMM6,XMM2
	
	SHA256RNDS2   XMM8,XMM10,XMM0
	
	SHA256MSG1   XMM2,XMM3
	
	PSHUFD    XMM0,XMM0,0eh
	
	LEA       RDX, [RDX + 040h]
	
	PALIGNR   XMM1,XMM3,04h
	
	PADDD     XMM1,XMM6
	
	SHA256RNDS2   XMM10,XMM8,XMM0
	
	MOVDQA    XMM0,xmmword ptr [DAT_140059e40]
	
	SHA256MSG2   XMM1,XMM7
	
	PADDD     XMM0,XMM1
	
	MOVDQA    XMM4,XMM1
	
	PALIGNR   XMM4,XMM7,04h
	
	PADDD     XMM4,XMM2
	
	SHA256RNDS2   XMM8,XMM10,XMM0
	
	PSHUFD    XMM0,XMM0,0eh
	
	SHA256RNDS2   XMM10,XMM8,XMM0
	
	MOVDQA    XMM0,xmmword ptr [DAT_140059e90]
	
	
	SHA256MSG2   XMM4,XMM1
	
	PADDD     XMM0,XMM4
	
	MOVDQA    XMM5,XMM4
	
	PALIGNR   XMM5,XMM1,04h
	
	SHA256RNDS2   XMM8,XMM10,XMM0
	
	PSHUFD    XMM0,XMM0,0eh
	
	SHA256RNDS2   XMM10,XMM8,XMM0
	
	MOVDQA    XMM0,xmmword ptr [DAT_140059db0]
	
	SHA256MSG1   XMM3,XMM7
	
	PADDD     XMM5,XMM3
	
	SHA256MSG2   XMM5,XMM4
	
	PADDD     XMM0,XMM5
	
	MOVDQA    XMM3,XMM5
	
	PALIGNR   XMM3,XMM4,04h
	
	SHA256RNDS2   XMM8,XMM10,XMM0
	
	PSHUFD    XMM0,XMM0,0eh
	
	SHA256RNDS2   XMM10,XMM8,XMM0
	
	MOVDQA    XMM0,xmmword ptr [DAT_140059de0]
	
	
	SHA256MSG1   XMM7,XMM1
	
	PADDD     XMM3,XMM7
	
	SHA256MSG1   XMM1,XMM4
	
	SHA256MSG2   XMM3,XMM5
	
	PADDD     XMM0,XMM3
	
	MOVDQA    XMM2,XMM3
	
	PALIGNR   XMM2,XMM5,04h
	
	PADDD     XMM2,XMM1
	
	SHA256RNDS2   XMM8,XMM10,XMM0
	
	PSHUFD    XMM0,XMM0,0eh
	
	SHA256RNDS2   XMM10,XMM8,XMM0
	
	MOVDQA    XMM0,xmmword ptr [DAT_140059e10]
	
	SHA256MSG2   XMM2,XMM3
	
	PADDD     XMM0,XMM2
	
	MOVDQA    XMM1,XMM2
	
	PALIGNR   XMM1,XMM3,04h
	
	SHA256RNDS2   XMM8,XMM10,XMM0
	
	PSHUFD    XMM0,XMM0,0eh
	
	SHA256RNDS2   XMM10,XMM8,XMM0
	
	MOVDQA    XMM0,xmmword ptr [DAT_140059e30]
	
	
	SHA256MSG1   XMM4,XMM5
	
	PADDD     XMM1,XMM4
	
	SHA256MSG2   XMM1,XMM2
	
	PADDD     XMM0,XMM1
	
	SHA256RNDS2   XMM8,XMM10,XMM0
	
	PSHUFD    XMM0,XMM0, 0Eh
	
	SHA256RNDS2   XMM10,XMM8,XMM0
	
	MOVDQA    XMM0,XMM1
	
	PALIGNR   XMM0,XMM2, 4h
	
	SHA256MSG1   XMM5,XMM3
	
	PADDD     XMM0,XMM5
	
	SHA256MSG2   XMM0,XMM1
	
	PADDD     XMM0,xmmword ptr [DAT_140059e80]
	
	SHA256RNDS2   XMM8,XMM10,XMM0
	
	PSHUFD    XMM0,XMM0, 0Eh
	
	PADDD     XMM11,XMM8
	
	SHA256RNDS2   XMM10,XMM8,XMM0
	
	PADDD     XMM10,XMM9
	
	SUB       R8, 1h
	
	JNZ       LAB_140025230
	
	MOVAPS    XMM15,xmmword ptr [RSP]
	
	MOVAPS    XMM14,xmmword ptr [RSP + 10h]
	
	MOVAPS    XMM13,xmmword ptr [RSP + 20h]
	
	MOVAPS    XMM9,xmmword ptr [RSP + 60h]
	
	MOVAPS    XMM8,xmmword ptr [RSP + 70h]
	
	MOVAPS    XMM7,xmmword ptr [RSP + 80h]
	
	MOVAPS    XMM6,xmmword ptr [RSP + 90h]
LAB_140025555:
	MOVAPS    XMM12,xmmword ptr [RSP + 30h]
	
	PSHUFD    XMM1,XMM10, 1bh
	
	MOVAPS    XMM10,xmmword ptr [RSP + 50h]
	
	MOVDQA    XMM0,XMM1
	
	PSHUFD    XMM2,XMM11, 0B1h
	
	MOVAPS    XMM11,xmmword ptr [RSP + 40h]
	
	PBLENDW   XMM0,XMM2, 0F0h
	
	PALIGNR   XMM2,XMM1, 8h
	
	MOVDQU    xmmword ptr [RCX],XMM0
	
	MOVDQU    xmmword ptr [RCX + 10h],XMM2
	
	ADD       RSP, 0A8h
	
	RET
EncryptKey endp
end